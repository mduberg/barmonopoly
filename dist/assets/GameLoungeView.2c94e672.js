import{_ as v,s as h,f as d,g as y,i as f,h as N,M as x,$ as C,n as E,I as b,r as I,o as i,c as n,b as t,t as p,a as c,F as _,B as w,j as V,C as B,p as T,d as S}from"./index.f4e8a43c.js";const k="/assets/loadingIcon.bc3ad036.png";const L={name:"GameLoungeView",props:{gameId:String},data(){return{gameName:"",creator:"",createdByThisUser:!1,team1:[],team2:[],hostView:!1,showSpinner:!1,showLoading:!1,loadNum:"0"}},methods:{async startGame(){let e=new Date;e.setHours(e.getHours()+3);const a=h(d,"games",this.gameId);await y(a,{active:!0,endDate:e.toString()}),this.startLoading(),setTimeout(()=>{this.$router.push("/game/"+this.gameId)},2400)},startLoading(){this.showLoading=!0,setTimeout(()=>{document.getElementsByClassName("progress-bar").item(0).setAttribute("aria-valuenow","10"),document.getElementsByClassName("progress-bar").item(0).setAttribute("style","width:"+Number("10")+"%")},800),setTimeout(()=>{document.getElementsByClassName("progress-bar").item(0).setAttribute("aria-valuenow","39"),document.getElementsByClassName("progress-bar").item(0).setAttribute("style","width:"+Number("39")+"%")},1100),setTimeout(()=>{document.getElementsByClassName("progress-bar").item(0).setAttribute("aria-valuenow","65"),document.getElementsByClassName("progress-bar").item(0).setAttribute("style","width:"+Number("65")+"%")},1700),setTimeout(()=>{document.getElementsByClassName("progress-bar").item(0).setAttribute("aria-valuenow","100"),document.getElementsByClassName("progress-bar").item(0).setAttribute("style","width:"+Number("100")+"%")},2200),setTimeout(()=>{document.getElementsByClassName("progress-bar").item(0).setAttribute("aria-valuenow","100"),document.getElementsByClassName("progress-bar").item(0).setAttribute("style","width:"+Number("100")+"%")},2400)},async assignToTeams(e){for(console.log("nu k\xF6rs to be assigned med",e),e.sort(()=>Math.random()-.5);e.length>0;){let s=e.pop();if(console.log(s),this.team2.length>=this.team1.length){this.team1.includes(s.data().username)||this.team1.push(s.data().username);var a="1"}else{this.team2.includes(s.data().username)||this.team2.push(s.data().username);var a="2"}const u=h(d,"users",s.id);await y(u,{team:a})}}},async mounted(){let e=f().currentUser.displayName;console.log("inloggad \xE4r",e),this.showSpinner=!0;const a=h(d,"games",this.gameId),s=await N(a);s.exists()?(console.log("Document data:",s.data()),this.creator=s.data().creator,this.gameName=s.data().name,console.log("\xE4r detta samma?",e,this.creator),e==this.creator&&(this.hostView=!0)):console.log("No such document!");const u=x(E(d,"users"),C("inGame","==",this.gameId));b(u,r=>{var g=[];r.forEach(o=>{!this.team1.includes(o.data().username)&&!this.team2.includes(o.data().username)&&(o.data().team=="1"?this.team1.push(o.data().username):o.data().team=="2"&&this.team2.push(o.data().username),o.data().team!="1"&&o.data().team!="2"&&g.push(o))}),this.showSpinner=!1,this.assignToTeams(g)}),this.hostView||b(h(d,"games",this.gameId),{includeMetadataChanges:!0},r=>{r.data().active==!0&&(console.log("active \xE4r sann"),this.startLoading(),setTimeout(()=>{this.$router.push("/game/"+this.gameId)},2400))})}},m=e=>(T("data-v-135f576a"),e=e(),S(),e),A={key:0,style:{"text-align":"center"}},G={class:"headerBox"},R={style:""},$={key:0,style:{margin:"0 auto","font-size":"14px"}},U={key:1,style:{margin:"0 auto","font-size":"14px"}},D={class:"rowContent"},M={key:0,id:"spinner",class:"spinner-border",role:"status"},z=m(()=>t("span",{class:"sr-only"},"Loading...",-1)),F=[z],H={class:"listContent"},j=m(()=>t("div",{class:"teamTitle",style:{"background-color":"rgb(200, 30, 30)"}},"STRYKJ\xC4RNEN",-1)),q={class:"list-group"},J={id:"listElement",class:"list-group-item"},K={class:"textCenter"},O={class:"listContent"},P=m(()=>t("div",{class:"teamTitle",style:{"background-color":"rgb(30, 30, 200)"}},"FINGERBORGARNA",-1)),Y={class:"list-group"},Q={id:"listElement",class:"list-group-item"},W={key:1,style:{"text-align":"center"}},X=m(()=>t("img",{id:"loadingIcon",style:{width:"90px","margin-top":"80px"},src:k},null,-1)),Z=m(()=>t("h4",{style:{"margin-top":"50px","font-size":"14px"}},"Spelet startas...",-1)),ee=m(()=>t("div",{class:"progress",style:{width:"400px",margin:"30px auto"}},[t("div",{class:"progress-bar",role:"progressbar",style:{width:"0%"},"aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"})],-1)),te=[X,Z,ee];function se(e,a,s,u,r,g){const o=I("vue-slider");return i(),n(_,null,[r.showLoading?c("",!0):(i(),n("div",A,[t("div",G,[t("h1",R,p(this.gameName),1)]),this.hostView?(i(),n("h4",$,"V\xE4nta in spelarna och starta sedan spelet")):(i(),n("h4",U,"V\xE4ntar p\xE5 att spelledaren ska starta spelet...")),t("div",D,[this.showSpinner?(i(),n("div",M,F)):c("",!0),t("div",H,[j,(i(!0),n(_,null,w(this.team1,l=>(i(),n("ul",q,[t("li",J,[t("div",K,p(l),1)])]))),256))]),t("div",O,[P,(i(!0),n(_,null,w(this.team2,l=>(i(),n("ul",Y,[t("li",Q,p(l),1)]))),256))])]),V(o,B({ref:"slider",modelValue:this.value,"onUpdate:modelValue":a[0]||(a[0]=l=>this.value=l)},this.options),null,16,["modelValue"]),this.hostView?(i(),n("button",{key:2,onClick:a[1]||(a[1]=l=>this.startGame()),style:{width:"150px",margin:"0 auto"},type:"button",class:"btn btn-success"},"Starta spelet")):c("",!0)])),r.showLoading?(i(),n("div",W,te)):c("",!0)],64)}const oe=v(L,[["render",se],["__scopeId","data-v-135f576a"]]);export{oe as default};
